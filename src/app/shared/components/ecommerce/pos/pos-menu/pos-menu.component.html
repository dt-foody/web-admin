<div class="flex flex-col h-full">
  <div class="p-4 border-b border-gray-200 dark:border-gray-700 pt-0 pl-0">
    <app-input-field
      type="text"
      placeholder="Tìm sản phẩm..."
      [(value)]="searchQuery"
      (valueChange)="filterProducts()"
    />
  </div>

  <div class="p-4 border-b border-gray-200 dark:border-gray-700 pl-0">
    <div class="flex flex-wrap items-center gap-2">
      <app-button
        size="sm"
        [variant]="selectedCategory === 'all' ? 'primary' : 'outline'"
        (btnClick)="onSelectCategory('all')"
        className="rounded-full"
      >
        Tất cả
      </app-button>
      <app-button
        size="sm"
        [variant]="selectedCategory === 'coffee' ? 'primary' : 'outline'"
        (btnClick)="onSelectCategory('coffee')"
        className="rounded-full"
      >
        Coffee
      </app-button>
      <app-button
        size="sm"
        [variant]="selectedCategory === 'tea' ? 'primary' : 'outline'"
        (btnClick)="onSelectCategory('tea')"
        className="rounded-full"
      >
        Trà
      </app-button>
      <app-button
        size="sm"
        [variant]="selectedCategory === 'cakes' ? 'primary' : 'outline'"
        (btnClick)="onSelectCategory('cakes')"
        className="rounded-full"
      >
        Bánh ngọt
      </app-button>
    </div>
  </div>

  <div class="p-4 pl-0">
    @if (filteredProducts.length > 0) {
      <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">
        @for (product of filteredProducts; track product.id) {
          <button
            (click)="onProductClick(product)"
            class="flex flex-col justify-between p-2 rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 shadow-sm hover:border-brand-500 hover:shadow-md transition"
          >
            <div class="w-full h-24 bg-gray-100 dark:bg-gray-700 rounded-md mb-2 flex items-center justify-center overflow-hidden">
              @if(product.image) {
                <img [src]="product.image" alt="{{ product.name }}" class="h-full w-full object-cover">
              } @else {
                <svg class="w-10 h-10 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l-1.586-1.586a2 2 0 00-2.828 0L6 16m12 4H6a2 2 0 01-2-2V6a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2z"></path></svg>
              }
            </div>
            
            <span
              class="text-sm font-medium text-center text-gray-800 dark:text-white line-clamp-2 h-10"
            >
              {{ product.name }}
            </span>
            <span class="text-xs font-semibold text-brand-600 dark:text-brand-400 mt-1">
              {{ product?.basePrice | number: '1.0-0' }}đ
            </span>
          </button>
        }
      </div>
    } @else {
      <div class="flex items-center justify-center h-full text-gray-400 py-10">
        <p>Không tìm thấy sản phẩm</p>
      </div>
    }
  </div>
</div>